<?xml version="1.0" encoding="UTF-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Appcanary</title>
  <subtitle>Appcanary makes sure you never run vulnerable software on your servers.Subscribe to our newsletter!</subtitle>
  <id>http://blog.appcanary.com</id>
  <link href="http://blog.appcanary.com"/>
  <link href="http://blog.appcanary.com/rss" rel="self"/>
  <updated>2017-01-15T19:00:00-05:00</updated>
  <entry>
    <title>New Year, New Appcanary Features</title>
    <link rel="alternate" href="http://blog.appcanary.com/2017/new-year-new-appcanary.html"/>
    <id>http://blog.appcanary.com/2017/new-year-new-appcanary.html</id>
    <published>2017-01-15T19:00:00-05:00</published>
    <updated>2017-01-20T16:09:23-05:00</updated>
    <author>
      <name>Max Veytsman</name>
    </author>
    <summary type="html">&lt;p&gt;We’ve been hard at work the past few months on lots of features touching every aspect of our product, and to ring in the new year, we’re going to announce them all at once.&lt;/p&gt;

&lt;h2 id="search-our-vulnerabilities"&gt;Search our vulnerabilities&lt;/h2&gt;

&lt;p&gt;You can now browse and search every vulnerability...&lt;/p&gt;</summary>
    <content type="html">&lt;p&gt;We&amp;rsquo;ve been hard at work the past few months on lots of features touching every aspect of our product, and to ring in the new year, we&amp;rsquo;re going to announce them all at once.&lt;/p&gt;

&lt;h2 id="search-our-vulnerabilities"&gt;Search our vulnerabilities&lt;/h2&gt;

&lt;p&gt;You can now browse and search every vulnerability Appcanary knows about! It&amp;rsquo;s pretty snazzy:&lt;/p&gt;

&lt;p&gt;&lt;img alt="browse our vulnerabilities" src="/images/vuln_browse.png" /&gt;&lt;/p&gt;

&lt;h2 id="automatically-upgrade-packages"&gt;Automatically upgrade packages&lt;/h2&gt;

&lt;p&gt;We&amp;rsquo;ve had this feature for Ubuntu, and now we&amp;rsquo;re adding it for CentOS.&lt;/p&gt;

&lt;p&gt;If you have the appcanary agent installed, you can run &lt;code&gt;appcanary upgrade&lt;/code&gt;, and
we&amp;rsquo;ll automatically upgrade all of your vulnerable packages to the lowest
version that fixes all the vulnerabilities we know about.&lt;/p&gt;

&lt;h2 id="resolve-vulnerabilities"&gt;Resolve vulnerabilities&lt;/h2&gt;

&lt;p&gt;There&amp;rsquo;s now a &amp;ldquo;marked resolved&amp;rdquo; button that lets us know that you don&amp;rsquo;t want to be notified about a vulnerability. This is used if a vulnerability doesn&amp;rsquo;t affect you, or if you are accepting the risk based on some other mitigation&amp;rsquo;s (i.e. you&amp;rsquo;re not using the vulnerable feature of the package, the port in question is blocked by a firewall, etc). We give you the opportunity to record your reasoning and provide a full audit trail of every vulnerability you mark as resolved:&lt;/p&gt;

&lt;p&gt;&lt;img alt="audit log" src="/images/audit_log.png" /&gt;&lt;/p&gt;

&lt;h2 id="brand-new-dashboard"&gt;Brand new dashboard&lt;/h2&gt;

&lt;p&gt;We just pushed a brand new UX for our dashboard. You can sort and search and sort all of your servers and monitors. Check it &lt;a href="https://appcanary.com/dashboard"&gt;out&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img alt="new dashboard" src="/images/new_dashboard.png" /&gt;&lt;/p&gt;

&lt;h2 id="the-appcanary-rubygem"&gt;The Appcanary rubygem&lt;/h2&gt;

&lt;p&gt;We released the &lt;a href="https://rubygems.org/gems/appcanary"&gt;Appcanary gem&lt;/a&gt;. This gives us tighter integration with ruby projects, you can either check your ruby project for vulnerabilities as a one-time check, or set up a monitor with notifications. You can see the source &lt;a href="https://github.com/appcanary/appcanary.rb"&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Our gem is still very early, so we very much want your feedback. Please let us know what you think at &lt;a href="mailto:hello@appcanary.com"&gt;hello@appcanary.com&lt;/a&gt;&lt;/p&gt;

&lt;h2 id="centos-6-support"&gt;CentOS 6 support&lt;/h2&gt;

&lt;p&gt;Last but not lease, we fully support CentOS 6 along with CentOS 7.&lt;/p&gt;
</content>
    <category term="Announcements"/>
    <category term="Product"/>
  </entry>
  <entry>
    <title>Everything you need to know about HTTP security headers</title>
    <link rel="alternate" href="http://blog.appcanary.com/2017/http-security-headers.html"/>
    <id>http://blog.appcanary.com/2017/http-security-headers.html</id>
    <published>2017-01-12T19:00:00-05:00</published>
    <updated>2017-01-20T16:09:23-05:00</updated>
    <author>
      <name>Max Veytsman</name>
    </author>
    <summary type="html">&lt;p&gt;Some physicists 28 years ago needed a way to easily share experimental data and
thus the web was born.  This was generally considered to be a good move.
Unfortunately, everything physicists touch — from trigonometry to the
strong nuclear force — eventually...&lt;/p&gt;</summary>
    <content type="html">&lt;p&gt;Some physicists 28 years ago needed a way to easily share experimental data and
thus the web was born.  This was generally considered to be a good move.
Unfortunately, everything physicists touch &amp;mdash; from trigonometry to the
strong nuclear force &amp;mdash; eventually becomes weaponized and so too has the
Hypertext Transfer Protocol. &lt;/p&gt;

&lt;p&gt;What can be attacked must be defended, and since tradition requires all security
features to be a bolted-on afterthought, things… got a little complicated. &lt;/p&gt;

&lt;p&gt;This article explains what secure headers are and how to implement these headers
in Rails, Django, Express.js, Go, Nginx, and Apache.&lt;/p&gt;

&lt;p&gt;Please note that some
headers may be best configured in on your HTTP servers, while others should be
set on the application layer. Use your own discretion here. You can test how well you&amp;rsquo;re doing with Mozilla&amp;rsquo;s
&lt;a href="https://observatory.mozilla.org/analyze.html?host=appcanary.com"&gt;Observatory&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Did we get anything wrong? Contact us at &lt;a href="mailto:hello@appcanary.com"&gt;hello@appcanary.com&lt;/a&gt;.&lt;/p&gt;

&lt;h2&gt;HTTP Security Headers&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;
&lt;a href="#x-xss-protection"&gt;X-XSS-Protection&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;a href="#why"&gt;Why?&lt;/a&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;a href="#should-i-use-it"&gt;Should I use it?&lt;/a&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;a href="#how"&gt;How?&lt;/a&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;a href="#i-want-to-know-more"&gt;I want to know more&lt;/a&gt;
&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;/li&gt;
&lt;li&gt;
&lt;a href="#content-security-policy"&gt;Content Security Policy&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;a href="#why"&gt;Why?&lt;/a&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;a href="#should-i-use-it"&gt;Should I use it?&lt;/a&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;a href="#how"&gt;How?&lt;/a&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;a href="#i-want-to-know-more"&gt;I want to know more&lt;/a&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;a href="#http-strict-transport-security-hsts"&gt;HTTP Strict Transport Security (HSTS)&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;a href="#why"&gt;Why?&lt;/a&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;a href="#should-i-use-it"&gt;Should I use it?&lt;/a&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;a href="#how"&gt;How?&lt;/a&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;a href="#i-want-to-know-more"&gt;I want to know more&lt;/a&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;a href="#http-public-key-pinning-hpkp"&gt;HTTP Public Key Pinning (HPKP)&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;a href="#why"&gt;Why?&lt;/a&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;a href="#should-i-use-it"&gt;Should I use it?&lt;/a&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;a href="#how"&gt;How?&lt;/a&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;a href="#i-want-to-know-more"&gt;I want to know more&lt;/a&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;a href="#x-frame-options"&gt;X-Frame-Options&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;a href="#why"&gt;Why?&lt;/a&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;a href="#should-i-use-it"&gt;Should I use it?&lt;/a&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;a href="#how"&gt;How?&lt;/a&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;a href="#i-want-to-know-more"&gt;I want to know more&lt;/a&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;a href="#x-content-type-options"&gt;X-Content-Type-Options&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;a href="#why"&gt;Why?&lt;/a&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;a href="#should-i-use-it"&gt;Should I use it?&lt;/a&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;a href="#how"&gt;How?&lt;/a&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;a href="#referrer-policy"&gt;Referrer-Policy&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;a href="#why"&gt;Why?&lt;/a&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;a href="#should-i-use-it"&gt;Should I use it?&lt;/a&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;a href="#how"&gt;How?&lt;/a&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;a href="#i-want-to-know-more"&gt;I want to know more&lt;/a&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;a href="#cookie-options"&gt;Cookie Options&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;a href="#why"&gt;Why?&lt;/a&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;a href="#should-i-use-it"&gt;Should I use it?&lt;/a&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;a href="#how"&gt;How?&lt;/a&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;&lt;/p&gt;

&lt;h2 id="x-xss-protection"&gt;X-XSS-Protection&lt;/h2&gt;
&lt;pre class="highlight plaintext"&gt;&lt;code&gt;X-XSS-Protection: 0;
X-XSS-Protection: 1;
X-XSS-Protection: 1; mode=block
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id="why"&gt;Why?&lt;/h3&gt;

&lt;p&gt;Cross Site Scripting, commonly abbreviated XSS, is an attack where the attacker
causes a page to load some malicious javascript.  &lt;code&gt;X-XSS-Protection&lt;/code&gt; is a
feature in Chrome and Internet Explorer that is designed to protect against
&amp;ldquo;reflected&amp;rdquo; XSS attacks &amp;mdash; where an attacker is sending the malicious
payload as part of the request&lt;sup id="fnref1"&gt;&lt;a href="#fn1" rel="footnote"&gt;1&lt;/a&gt;&lt;/sup&gt;.&lt;/p&gt;

&lt;p&gt;&lt;code&gt;X-XSS-Protection: 0&lt;/code&gt; turns it off.&lt;br/&gt;
&lt;code&gt;X-XSS-Protection: 1&lt;/code&gt; will filter out scripts that came from the request - but
will still render the page&lt;br/&gt; 
&lt;code&gt;X-XSS-Protection: 1; mode=block&lt;/code&gt; when triggered, will block the whole page from being rendered.&lt;/p&gt;

&lt;h3 id="should-i-use-it"&gt;Should I use it?&lt;/h3&gt;

&lt;p&gt;Yes. Set &lt;code&gt;X-XSS-Protection: 1; mode=block&lt;/code&gt;. The &amp;ldquo;filter bad scripts&amp;rdquo; mechanism is problematic; see &lt;a href="http://blog.innerht.ml/the-misunderstood-x-xss-protection/"&gt;here&lt;/a&gt; for why.&lt;/p&gt;

&lt;h3 id="how"&gt;How?&lt;/h3&gt;

&lt;table&gt;&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Platform&lt;/th&gt;
&lt;th&gt;What do I do?&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Rails 4 and 5&lt;/td&gt;
&lt;td&gt;On by default&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Django&lt;/td&gt;
&lt;td&gt;&lt;code&gt;SECURE_BROWSER_XSS_FILTER = True&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Express.js&lt;/td&gt;
&lt;td&gt;Use &lt;a href="https://helmetjs.github.io/docs/xss-filter/"&gt;helmet&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Go&lt;/td&gt;
&lt;td&gt;Use &lt;a href="https://github.com/unrolled/secure"&gt;unrolled/secure&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Nginx&lt;/td&gt;
&lt;td&gt;&lt;code&gt;add_header X-XSS-Protection &amp;quot;1; mode=block&amp;quot;;&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Apache&lt;/td&gt;
&lt;td&gt;&lt;code&gt;Header always set X-XSS-Protection &amp;quot;1; mode=block&amp;quot;&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;

&lt;h3 id="i-want-to-know-more"&gt;I want to know more&lt;/h3&gt;

&lt;p&gt;&lt;a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-XSS-Protection"&gt;X-XSS-Protection - MDN&lt;/a&gt;&lt;/p&gt;

&lt;hr&gt;

&lt;h2 id="content-security-policy"&gt;Content Security Policy&lt;/h2&gt;
&lt;pre class="highlight plaintext"&gt;&lt;code&gt;Content-Security-Policy: &amp;lt;policy&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id="why"&gt;Why?&lt;/h3&gt;

&lt;p&gt;Content Security Policy can be thought of as much more advanced version of the
&lt;code&gt;X-XSS-Protection&lt;/code&gt; header above. While &lt;code&gt;X-XSS-Protection&lt;/code&gt; will block scripts
that come from the request, it&amp;rsquo;s not going to stop an XSS attack that involves
storing a malicious script on your server or loading an external resource with a
malicious script in it.&lt;/p&gt;

&lt;p&gt;CSP gives you a language to define where the browser can load resources from.
You can white list origins for scripts, images, fonts, stylesheets, etc in a very
granular manner. You can also compare any loaded content against a hash or
signature.&lt;/p&gt;

&lt;h3 id="should-i-use-it"&gt;Should I use it?&lt;/h3&gt;

&lt;p&gt;Yes. It won&amp;rsquo;t prevent all XSS attacks, but it&amp;rsquo;s a significant mitigation against
their impact, and an important aspect of defense-in-depth. That said, it can be
hard to implement. If you&amp;rsquo;re an intrepid reader and went ahead and checked the
headers &lt;a href="https://appcanary.com"&gt;appcanary.com&lt;/a&gt; returns&lt;sup id="fnref2"&gt;&lt;a href="#fn2" rel="footnote"&gt;2&lt;/a&gt;&lt;/sup&gt;, you&amp;rsquo;ll see that we don&amp;rsquo;t
have CSP implemented yet. There are some rails development plugins we&amp;rsquo;re using
that are holding us back from a CSP implementation that will have an actually security impact.
We&amp;rsquo;re working on it, and will write about it in the next instalment!&lt;/p&gt;

&lt;h3 id="how"&gt;How?&lt;/h3&gt;

&lt;p&gt;Writing a CSP policy can be challenging.
See
&lt;a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy"&gt;here&lt;/a&gt; for
a list of all the directives you can employ. A good place to start
is &lt;a href="https://csp.withgoogle.com/docs/adopting-csp.html"&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;table&gt;&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Platform&lt;/th&gt;
&lt;th&gt;What do I do?&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Rails 4 and 5&lt;/td&gt;
&lt;td&gt;Use &lt;a href="https://github.com/twitter/secureheaders"&gt;secureheaders&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Django&lt;/td&gt;
&lt;td&gt;Use &lt;a href="https://github.com/mozilla/django-csp"&gt;django-csp&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Express.js&lt;/td&gt;
&lt;td&gt;Use &lt;a href="https://github.com/helmetjs/csp"&gt;helmet/csp&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Go&lt;/td&gt;
&lt;td&gt;Use &lt;a href="https://github.com/unrolled/secure"&gt;unrolled/secure&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Nginx&lt;/td&gt;
&lt;td&gt;&lt;code&gt;add_header Content-Security-Policy &amp;quot;&amp;lt;policy&amp;gt;&amp;quot;;&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Apache&lt;/td&gt;
&lt;td&gt;&lt;code&gt;Header always set Content-Security-Policy &amp;quot;&amp;lt;policy&amp;gt;&amp;quot;&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;

&lt;h3 id="i-want-to-know-more"&gt;I want to know more&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy"&gt;Content-Security-Policy - MDN&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://content-security-policy.com/"&gt;CSP Quick Reference Guide&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://csp.withgoogle.com/docs/index.html"&gt;Google&amp;rsquo;s CSP Guide&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;hr&gt;

&lt;h2 id="http-strict-transport-security-hsts"&gt;HTTP Strict Transport Security (HSTS)&lt;/h2&gt;
&lt;pre class="highlight plaintext"&gt;&lt;code&gt;Strict-Transport-Security: max-age=&amp;lt;expire-time&amp;gt;
Strict-Transport-Security: max-age=&amp;lt;expire-time&amp;gt;; includeSubDomains
Strict-Transport-Security: max-age=&amp;lt;expire-time&amp;gt;; preload
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id="why"&gt;Why?&lt;/h3&gt;

&lt;p&gt;When we want to securely communicate with someone, we face two problems. The
first problem is privacy; we want to make sure the messages we send can only
be read by the recipient, and no one else. The other problem is that of
authentication: how do we know the recipient is who they say they are?&lt;/p&gt;

&lt;p&gt;HTTPS solves the first problem with encryption, though it has some major issues
with authentication (more on this later, see &lt;a href="#http-public-key-pinning-hpkp"&gt;Public Key
Pinning&lt;/a&gt;). The HSTS header solves the
meta-problem: how do you know if the person you&amp;rsquo;re talking to actually supports
encryption?&lt;/p&gt;

&lt;p&gt;HSTS mitigates an attack called
&lt;a href="https://moxie.org/software/sslstrip/"&gt;sslstrip&lt;/a&gt;. Suppose you&amp;rsquo;re using a hostile
network, where a malicious attacker controls the wifi router. The attacker can
disable encryption between you and the websites you&amp;rsquo;re browsing. Even if the
site you&amp;rsquo;re accessing is only available over HTTPS, the attacker can
man-in-the-middle the HTTP traffic and make it look like the site works over
unencrypted HTTP. No need for SSL certs, just disable the encryption.&lt;/p&gt;

&lt;p&gt;Enter the HSTS. The &lt;code&gt;Strict-Transport-Security&lt;/code&gt; header solves this by letting
your browser know that it must always use encryption with your site. As long as
your browser has seen an HSTS header &amp;mdash; and it hasn&amp;rsquo;t expired &amp;mdash; it
will not access the site unencrypted, and will error out if it&amp;rsquo;s not available
over HTTPS.&lt;/p&gt;

&lt;h3 id="should-i-use-it"&gt;Should I use it?&lt;/h3&gt;

&lt;p&gt;Yes. Your app is only available over HTTPS, right? Trying to browse over regular
old HTTP will redirect to the secure site, right? (Hint: Use
&lt;a href="https://letsencrypt.org/"&gt;letsencrypt&lt;/a&gt; if you want to avoid the racket that are
commercial certificate authorities.)&lt;/p&gt;

&lt;p&gt;The one downside of the HSTS header is that it allows for a &lt;a href="http://www.radicalresearch.co.uk/lab/hstssupercookies"&gt;clever
technique&lt;/a&gt; to create
supercookies that can fingerprint your users. As a website operator, you
probably already track your users somewhat - but try to only use HSTS for good
and not for supercookies.&lt;/p&gt;

&lt;h3 id="how"&gt;How?&lt;/h3&gt;

&lt;p&gt;The two options are&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;includeSubDomains&lt;/code&gt; - HSTS applies to subdomains&lt;/li&gt;
&lt;li&gt;&lt;code&gt;preload&lt;/code&gt; - Google maintains a &lt;a href="https://hstspreload.appspot.com/"&gt;service&lt;/a&gt;
that hardcodes&lt;sup id="fnref3"&gt;&lt;a href="#fn3" rel="footnote"&gt;3&lt;/a&gt;&lt;/sup&gt; your site as being HTTPS only into browsers. This
way, a user doesn&amp;rsquo;t even have to visit your site: their browser already knows
it should reject unencrypted connections.
Getting off that list is hard, by the way, so only turn it on if you know you
can support HTTPS forever on all your subdomains.&lt;/li&gt;
&lt;/ul&gt;

&lt;table&gt;&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Platform&lt;/th&gt;
&lt;th&gt;What do I do?&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Rails 4&lt;/td&gt;
&lt;td&gt;&lt;code&gt;config.force_ssl = true&lt;/code&gt;&lt;br/&gt;Does not include subdomains by default. To set it:&lt;br/&gt;&lt;code&gt;config.ssl_options = { hsts: { subdomains: true } }&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Rails 5&lt;/td&gt;
&lt;td&gt;&lt;code&gt;config.force_ssl = true&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Django&lt;/td&gt;
&lt;td&gt;&lt;code&gt;SECURE_HSTS_SECONDS = 31536000&lt;/code&gt; &lt;br/&gt; &lt;code&gt;SECURE_HSTS_INCLUDE_SUBDOMAINS = True&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Express.js&lt;/td&gt;
&lt;td&gt;Use &lt;a href="https://helmetjs.github.io/docs/hsts/"&gt;helmet&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Go&lt;/td&gt;
&lt;td&gt;Use &lt;a href="https://github.com/unrolled/secure"&gt;unrolled/secure&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Nginx&lt;/td&gt;
&lt;td&gt;&lt;code&gt;add_header Strict-Transport-Security &amp;quot;max-age=31536000; includeSubdomains; &amp;quot;;&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Apache&lt;/td&gt;
&lt;td&gt;&lt;code&gt;Header always set Strict-Transport-Security &amp;quot;max-age=31536000; includeSubdomains;&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;

&lt;h3 id="i-want-to-know-more"&gt;I want to know more&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href="https://tools.ietf.org/html/rfc6797"&gt;RFC 6797&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Strict-Transport-Security"&gt;Strict-Transport-Security - MDN&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;hr&gt;

&lt;h2 id="http-public-key-pinning-hpkp"&gt;HTTP Public Key Pinning (HPKP)&lt;/h2&gt;
&lt;pre class="highlight plaintext"&gt;&lt;code&gt;Public-Key-Pins: pin-sha256=&amp;lt;base64==&amp;gt;; max-age=&amp;lt;expireTime&amp;gt;;
Public-Key-Pins: pin-sha256=&amp;lt;base64==&amp;gt;; max-age=&amp;lt;expireTime&amp;gt;; includeSubDomains
Public-Key-Pins: pin-sha256=&amp;lt;base64==&amp;gt;; max-age=&amp;lt;expireTime&amp;gt;; report-uri=&amp;lt;reportURI&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id="why"&gt;Why?&lt;/h3&gt;

&lt;p&gt;The HSTS header described above was designed to ensure that all connections to your
website are encrypted. However, nowhere does it specify what key to use! &lt;/p&gt;

&lt;p&gt;Trust on the
web is based on the certificate authority (CA) model. Your browser and operating system
ship with the public keys of some trusted certificate authorities which are
usually specialized companies and/or nation states. When a CA issues you a
certificate for a given domain that means anyone who trusts that CA will
automatically trust the SSL traffic you encrypt using that certificate.  The CAs
are responsible for verifying that you actually own a domain (this can be
anything from sending an email, to asking you to host a file, to investigating
your company).&lt;/p&gt;

&lt;p&gt;Two CAs can issue a certificate for the same domain to two different people, and
browsers will trust both. This creates a problem, especially since CAs &lt;a href="https://technet.microsoft.com/library/security/2524375"&gt;can be
and are&lt;/a&gt; compromised.
This allows attackers to MiTM any domain they want, even if that domain uses SSL
&amp;amp; HSTS!&lt;/p&gt;

&lt;p&gt;The HPKP header tries to mitigate this. This header lets you to &amp;ldquo;pin&amp;rdquo; a
certificate. When a browser sees the header for the first time, it will save the
certificate. For every request up to &lt;code&gt;max-age&lt;/code&gt;, the browser will fail unless at
least one certificate in the chain sent from the server has a fingerprint that
was pinned.&lt;/p&gt;

&lt;p&gt;This means that you can pin to the CA or a intermediate certificate along with
the leaf in order to not shoot yourself in the foot (more on this later).&lt;/p&gt;

&lt;p&gt;Much like HSTS above, the HPKP header also has some privacy implications.
These were laid out in the &lt;a href="https://tools.ietf.org/html/rfc7469#section-5"&gt;RFC&lt;/a&gt;
itself.&lt;/p&gt;

&lt;h3 id="should-i-use-it"&gt;Should I use it?&lt;/h3&gt;

&lt;p&gt;Probably not. &lt;/p&gt;

&lt;p&gt;HPKP is a very very sharp knife. Consider this: if you pin to the wrong
certificate, or you lose your keys, or something else goes wrong, you&amp;rsquo;ve locked
your users out of your site. All you can do is wait for the pin to expire.&lt;/p&gt;

&lt;p&gt;This
&lt;a href="https://blog.qualys.com/ssllabs/2016/09/06/is-http-public-key-pinning-dead"&gt;article&lt;/a&gt;
lays out the case against it, and includes a fun way for attackers to use HPKP
to hold their victims ransom.&lt;/p&gt;

&lt;p&gt;One alternative is using the &lt;code&gt;Public-Key-Pins-Report-Only&lt;/code&gt; header, which will
just report that something went wrong, but not lock anyone out. This allows you
to at least know your users are being MiTMed with fake certificates.&lt;/p&gt;

&lt;h3 id="how"&gt;How?&lt;/h3&gt;

&lt;p&gt;The two options are&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;includeSubDomains&lt;/code&gt; - HPKP applies to subdomains&lt;/li&gt;
&lt;li&gt;&lt;code&gt;report-uri&lt;/code&gt; - Inavlid attempts will be reported here&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;You have to generate a base64 encoded fingerprint for the key you pin to, and
you &lt;strong&gt;have&lt;/strong&gt; to use a backup key.  Check &lt;a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Public_Key_Pinning#Extracting_the_Base64_encoded_public_key_information"&gt;this
guide&lt;/a&gt;
for how to do it.&lt;/p&gt;

&lt;table&gt;&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Platform&lt;/th&gt;
&lt;th&gt;What do I do?&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Rails 4 and 5&lt;/td&gt;
&lt;td&gt;Use &lt;a href="https://github.com/twitter/secureheaders/blob/master/docs/HPKP.md"&gt;secureheaders&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Django&lt;/td&gt;
&lt;td&gt;Write custom middleware&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Express.js&lt;/td&gt;
&lt;td&gt;Use &lt;a href="https://helmetjs.github.io/docs/hpkp/"&gt;helmet&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Go&lt;/td&gt;
&lt;td&gt;Use &lt;a href="https://github.com/unrolled/secure"&gt;unrolled/secure&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Nginx&lt;/td&gt;
&lt;td&gt;&lt;code&gt;add_header Public-Key-Pins &amp;#39;pin-sha256=&amp;quot;&amp;lt;primary&amp;gt;&amp;quot;; pin-sha256=&amp;quot;&amp;lt;backup&amp;gt;&amp;quot;; max-age=5184000; includeSubDomains&amp;#39;;&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Apache&lt;/td&gt;
&lt;td&gt;&lt;code&gt;Header always set Public-Key-Pins &amp;#39;pin-sha256=&amp;quot;&amp;lt;primary&amp;gt;&amp;quot;; pin-sha256=&amp;quot;&amp;lt;backup&amp;gt;&amp;quot;; max-age=5184000; includeSubDomains&amp;#39;;&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;

&lt;h3 id="i-want-to-know-more"&gt;I want to know more&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href="https://tools.ietf.org/html/rfc7469"&gt;RFC 7469&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Public_Key_Pinning"&gt;HTTP Public Key Pinning (HPKP) - MDN&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;hr&gt;

&lt;h2 id="x-frame-options"&gt;X-Frame-Options&lt;/h2&gt;
&lt;pre class="highlight plaintext"&gt;&lt;code&gt;X-Frame-Options: DENY
X-Frame-Options: SAMEORIGIN
X-Frame-Options: ALLOW-FROM https://example.com/
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id="why"&gt;Why?&lt;/h3&gt;

&lt;p&gt;Before we started giving dumb names to vulnerabilities, we used to give dumb
names to hacking techniques. &amp;ldquo;Clickjacking&amp;rdquo; is one of those dumb names. &lt;/p&gt;

&lt;p&gt;The idea goes like this: you create an invisible iframe, place it in focus and
route user input into it. As an attacker, you can then trick people into playing
a browser-based game while their clicks are being registered by a hidden iframe
displaying twitter - forcing them to non-consensually retweet all of your
tweets.&lt;/p&gt;

&lt;p&gt;It sounds dumb, but it&amp;rsquo;s an effective attack.&lt;/p&gt;

&lt;h3 id="should-i-use-it"&gt;Should I use it?&lt;/h3&gt;

&lt;p&gt;Yes. Your app is a beautiful snowflake. Do you really want some
&lt;a href="https://techcrunch.com/2015/04/08/annotate-this/"&gt;genius&lt;/a&gt; shoving it into an
iframe so they can vandalize it?&lt;/p&gt;

&lt;h3 id="how"&gt;How?&lt;/h3&gt;

&lt;p&gt;&lt;code&gt;X-Frame-Options&lt;/code&gt; has three modes, which are pretty self explanatory.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;DENY&lt;/code&gt; - No one can put this page in an iframe&lt;/li&gt;
&lt;li&gt;&lt;code&gt;SAMEORIGIN&lt;/code&gt; - The page can only be displayed in an iframe by someone on the same origin.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ALLOW-FROM&lt;/code&gt; - Specify a specific url that can put the page in an iframe&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;One thing to remember is that you can stack iframes as deep as you want, and in
that case, the behavior of &lt;code&gt;SAMEORIGIN&lt;/code&gt; and &lt;code&gt;ALLOW-FROM&lt;/code&gt; isn&amp;rsquo;t
&lt;a href="https://tools.ietf.org/html/rfc7034#section-2.3.2.2"&gt;specified&lt;/a&gt;. That is, if we
have a triple-decker iframe sandwich and the innermost iframe has &lt;code&gt;SAMEORIGIN&lt;/code&gt;,
do we care about the origin of the iframe around it, or the topmost one on the
page? ¯\_(ツ)_/¯.&lt;/p&gt;

&lt;table&gt;&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Platform&lt;/th&gt;
&lt;th&gt;What do I do?&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Rails 4 and 5&lt;/td&gt;
&lt;td&gt;&lt;code&gt;SAMEORIGIN&lt;/code&gt; is set by default.&lt;br/&gt;&lt;br/&gt;To set &lt;code&gt;DENY&lt;/code&gt;:&lt;br/&gt;&lt;code&gt;config.action_dispatch.default_headers[&amp;#39;X-Frame-Options&amp;#39;] = &amp;quot;DENY&amp;quot;&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Django&lt;/td&gt;
&lt;td&gt;&lt;code&gt;MIDDLEWARE = [ ... &amp;#39;django.middleware.clickjacking.XFrameOptionsMiddleware&amp;#39;, ... ]&lt;/code&gt;&lt;br/&gt; This defaults to &lt;code&gt;SAMORIGIN&lt;/code&gt;.&lt;br/&gt;&lt;br/&gt;To set &lt;code&gt;DENY&lt;/code&gt;: &lt;code&gt;X_FRAME_OPTIONS = &amp;#39;DENY&amp;#39;&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Express.js&lt;/td&gt;
&lt;td&gt;Use &lt;a href="https://helmetjs.github.io/docs/frameguard/"&gt;helmet&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Go&lt;/td&gt;
&lt;td&gt;Use &lt;a href="https://github.com/unrolled/secure"&gt;unrolled/secure&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Nginx&lt;/td&gt;
&lt;td&gt;&lt;code&gt;add_header X-Frame-Options &amp;quot;deny&amp;quot;;&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Apache&lt;/td&gt;
&lt;td&gt;&lt;code&gt;Header always set X-Frame-Options &amp;quot;deny&amp;quot;&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;

&lt;h3 id="i-want-to-know-more"&gt;I want to know more&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href="https://tools.ietf.org/html/rfc7034"&gt;RFC 7034&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options"&gt;X-Frame-Options - MDN&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;

&lt;hr&gt;

&lt;h2 id="x-content-type-options"&gt;X-Content-Type-Options&lt;/h2&gt;
&lt;pre class="highlight plaintext"&gt;&lt;code&gt;X-Content-Type-Options: nosniff;
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id="why"&gt;Why?&lt;/h3&gt;

&lt;p&gt;The problem this header solves is called &amp;ldquo;MIME sniffing&amp;rdquo;, which is actually a
browser &amp;ldquo;feature&amp;rdquo;. &lt;/p&gt;

&lt;p&gt;In theory, every time your server responds to a request it is supposed to set a
&lt;code&gt;Content-Type&lt;/code&gt; header in order to tell the browser if it&amp;rsquo;s getting some HTML, a
cat gif, or a Flash cartoon from 2008. Unfortunately, the web has always been
broken and has never really followed a spec for anything; back in the day lots
of people didn&amp;rsquo;t bother to set the content type header properly. &lt;/p&gt;

&lt;p&gt;As a result, browser vendors decided they should be really helpful and try to
infer the content type by inspecting the content itself while completely ignore
the content type header.  If it looks like a gif, display a gif!, even though
the content type is &lt;code&gt;text/html&lt;/code&gt;.  Likewise, if it looks like we got some HTML,
we should render it as such even if the server said it&amp;rsquo;s a gif.&lt;/p&gt;

&lt;p&gt;This is great, except when you&amp;rsquo;re running a photo-sharing site, and users can
upload photos that look like HTML with javascript included, and suddenly you
have a stored XSS attack on your hand.&lt;/p&gt;

&lt;p&gt;The &lt;code&gt;X-Content-Type-Options&lt;/code&gt; headers exist to tell the browser to shut up and
set the damn content type to what I tell you, thank you.&lt;/p&gt;

&lt;h3 id="should-i-use-it"&gt;Should I use it?&lt;/h3&gt;

&lt;p&gt;Yes, just make sure to set your content types correctly.&lt;/p&gt;

&lt;h3 id="how"&gt;How?&lt;/h3&gt;

&lt;table&gt;&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Platform&lt;/th&gt;
&lt;th&gt;What do I do?&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Rails 4 and 5&lt;/td&gt;
&lt;td&gt;On by default&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Django&lt;/td&gt;
&lt;td&gt;&lt;code&gt;SECURE_CONTENT_TYPE_NOSNIFF = True&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Express.js&lt;/td&gt;
&lt;td&gt;Use &lt;a href="https://helmetjs.github.io/docs/dont-sniff-mimetype/"&gt;helmet&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Go&lt;/td&gt;
&lt;td&gt;Use &lt;a href="https://github.com/unrolled/secure"&gt;unrolled/secure&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Nginx&lt;/td&gt;
&lt;td&gt;&lt;code&gt;add_header X-Content-Type-Options nosniff;&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Apache&lt;/td&gt;
&lt;td&gt;&lt;code&gt;Header always set X-Content-Type-Options nosniff&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;

&lt;hr&gt;

&lt;h2 id="referrer-policy"&gt;Referrer-Policy&lt;/h2&gt;
&lt;pre class="highlight plaintext"&gt;&lt;code&gt;Referrer-Policy: "no-referrer" 
Referrer-Policy: "no-referrer-when-downgrade" 
Referrer-Policy: "origin" 
Referrer-Policy: "origin-when-cross-origin"
Referrer-Policy: "same-origin" 
Referrer-Policy: "strict-origin" 
Referrer-Policy: "strict-origin-when-cross-origin" 
Referrer-Policy: "unsafe-url"
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id="why"&gt;Why?&lt;/h3&gt;

&lt;p&gt;Ah, the &lt;code&gt;Referer&lt;/code&gt; header. Great for analytics, bad for your users&amp;rsquo; privacy. At
some point the web got woke and decided that maybe it wasn&amp;rsquo;t a good idea to send
it all the time. And while we&amp;rsquo;re at it, let&amp;rsquo;s spell &amp;ldquo;Referrer&amp;rdquo;
correctly&lt;sup id="fnref4"&gt;&lt;a href="#fn4" rel="footnote"&gt;4&lt;/a&gt;&lt;/sup&gt;.&lt;/p&gt;

&lt;p&gt;The &lt;code&gt;Referrer-Policy&lt;/code&gt; header allows you to specify when the browser will set a
&lt;code&gt;Referer&lt;/code&gt; header.&lt;/p&gt;

&lt;h3 id="should-i-use-it"&gt;Should I use it?&lt;/h3&gt;

&lt;p&gt;It&amp;rsquo;s up to you, but it&amp;rsquo;s probably a good idea. If you don&amp;rsquo;t care about your
users&amp;rsquo; privacy, think of it as a way to keep your sweet sweet analytics to
yourself and out of your competitors&amp;rsquo; grubby hands.&lt;/p&gt;

&lt;p&gt;Set &lt;code&gt;Referrer-Policy: &amp;quot;no-referrer&amp;quot;&lt;/code&gt;&lt;/p&gt;

&lt;h3 id="how"&gt;How?&lt;/h3&gt;

&lt;table&gt;&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Platform&lt;/th&gt;
&lt;th&gt;What do I do?&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Rails 4 and 5&lt;/td&gt;
&lt;td&gt;Use &lt;a href="https://github.com/twitter/secureheaders"&gt;secureheaders&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Django&lt;/td&gt;
&lt;td&gt;Write custom middleware&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Express.js&lt;/td&gt;
&lt;td&gt;Use &lt;a href="https://helmetjs.github.io/docs/referrer-policy/"&gt;helmet&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Go&lt;/td&gt;
&lt;td&gt;Write custom middleware&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Nginx&lt;/td&gt;
&lt;td&gt;&lt;code&gt;add_header Referrer-Policy &amp;quot;no-referrer&amp;quot;;&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Apache&lt;/td&gt;
&lt;td&gt;&lt;code&gt;Header always set Referrer-Policy &amp;quot;no-referrer&amp;quot;&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;

&lt;h3 id="i-want-to-know-more"&gt;I want to know more&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-XSS-Protection"&gt;X-XSS-Protection - MDN&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;hr&gt;

&lt;h2 id="cookie-options"&gt;Cookie Options&lt;/h2&gt;
&lt;pre class="highlight plaintext"&gt;&lt;code&gt;Set-Cookie: &amp;lt;key&amp;gt;=&amp;lt;value&amp;gt;; Expires=&amp;lt;expiryDate&amp;gt;; Secure; HttpOnly; SameSite=strict
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id="why"&gt;Why?&lt;/h3&gt;

&lt;p&gt;This isn&amp;rsquo;t a security header per se, but there are three different options for
cookies that you should be aware of.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Cookies marked as &lt;code&gt;Secure&lt;/code&gt; will only be served over HTTPS. This prevents
someone from reading the cookies in a MiTM attack where they can force the
browser to visit a given page.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;HttpOnly&lt;/code&gt; is a misnomer, and has nothing to do with HTTPS (unlike &lt;code&gt;Secure&lt;/code&gt;
above). Cookies marked as &lt;code&gt;HttpOnly&lt;/code&gt; can not be accessed from within
javascript. So if there is an XSS flaw, the attacker can&amp;rsquo;t immediately steal
the cookies.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;SameSite&lt;/code&gt; helps defend against Cross-Origin Request Forgery (CSRF) attacks.
This is an attack where a different website the user may be visiting
inadvertently tricks them into making a request against your site, i.e. by
including an image to make a GET request, or using javascript to submit a form
for a POST request. Generally, people defend against this
using
&lt;a href="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)_Prevention_Cheat_Sheet"&gt;CSRF tokens&lt;/a&gt;.
A cookie marked as &lt;code&gt;SameSite&lt;/code&gt; won&amp;rsquo;t be sent to a different site.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;It has two modes, lax and strict. Lax mode allows the cookie to be sent in a
  top-level context for GET requests (i.e. if you clicked a link). Strict
  doesn&amp;rsquo;t send any third-party cookies.&lt;/p&gt;

&lt;h3 id="should-i-use-it"&gt;Should I use it?&lt;/h3&gt;

&lt;p&gt;You should absolutely set &lt;code&gt;Secure&lt;/code&gt; and &lt;code&gt;HttpOnly&lt;/code&gt;. Unfortunately, as of writing,
SameSite cookies are &lt;a href="http://caniuse.com/#search=samesite"&gt;available&lt;/a&gt; only in
Chrome and Opera, so you may want to ignore them for now.&lt;/p&gt;

&lt;h3 id="how"&gt;How?&lt;/h3&gt;

&lt;table&gt;&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Platform&lt;/th&gt;
&lt;th&gt;What do I do?&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Rails 4 and 5&lt;/td&gt;
&lt;td&gt;Secure and HttpOnly enabled by default. For SameSite, use &lt;a href="https://github.com/twitter/secureheaders"&gt;secureheaders&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Django&lt;/td&gt;
&lt;td&gt;Session cookies are HttpOnly by default. To set secure: &lt;code&gt;SESSION_COOKIE_SECURE = True&lt;/code&gt;. &lt;br/&gt;&lt;br/&gt; Not sure about SameSite.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Express.js&lt;/td&gt;
&lt;td&gt;&lt;code&gt;cookie: { secure: true, httpOnly: true, sameSite: true }&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Go&lt;/td&gt;
&lt;td&gt;&lt;code&gt;http.Cookie{Name: &amp;quot;foo&amp;quot;, Value: &amp;quot;bar&amp;quot;, HttpOnly: true, Secure: true}&lt;/code&gt; &lt;br/&gt;&lt;br/&gt; For SameSite, see this &lt;a href="https://github.com/golang/go/issues/15867"&gt;issue&lt;/a&gt;.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Nginx&lt;/td&gt;
&lt;td&gt;You probably won&amp;rsquo;t set session cookies in Nginx&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Apache&lt;/td&gt;
&lt;td&gt;You probably won&amp;rsquo;t set session cookies in Apache&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;

&lt;hr&gt;

&lt;p&gt;Thanks to &lt;a href="https://twitter.com/wolever"&gt;@wolever&lt;/a&gt; for python advice&lt;/p&gt;

&lt;p&gt;&lt;link href="//cdn-images.mailchimp.com/embedcode/horizontal-slim-10_7.css" rel="stylesheet" type="text/css"&gt;
&lt;style type="text/css"&gt;
 #mc&lt;em&gt;embed&lt;/em&gt;signup{background:#fff; clear:left; font:14px Helvetica,Arial,sans-serif; width:100%;}
 /* Add your own MailChimp form style overrides in your site stylesheet or in this style block.
      We recommend moving this block and the preceding CSS link to the HEAD of your HTML file. */
&lt;/style&gt;
&lt;div id="mc_embed_signup"&gt;
&lt;form action="//appcanary.us10.list-manage.com/subscribe/post?u=303b378f377508300c0b5469a&amp;amp;id=dc58e8f56f" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate&gt;
&lt;div id="mc_embed_signup_scroll"&gt;
&lt;label for="mce-EMAIL"&gt;Liked this post? Subscribe to our newsletter for more!&lt;/label&gt;
&lt;input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL" placeholder="email address" required&gt;
&lt;div style="position: absolute; left: -5000px;" aria-hidden="true"&gt;&lt;input type="text" name="b_303b378f377508300c0b5469a_dc58e8f56f" tabindex="-1" value=""&gt;&lt;/div&gt;
&lt;div class="clear"&gt;&lt;input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button"&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/form&gt;
&lt;/div&gt;&lt;/p&gt;

&lt;div class="footnotes"&gt;
&lt;hr&gt;
&lt;ol&gt;

&lt;li id="fn1"&gt;
&lt;p&gt;This is opposed to &amp;ldquo;stored&amp;rdquo; XSS attacks, where the attacker is storing
the malicious payload somehow, i.e. in a vulnerable comment field of a
message board.&amp;nbsp;&lt;a href="#fnref1" rev="footnote"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;

&lt;li id="fn2"&gt;
&lt;p&gt;If you&amp;rsquo;re going to point out in the Hacker News comments that
this blog itself gets an F from the Mozilla observatory, you&amp;rsquo;re right! On
the other hand, it&amp;rsquo;s serving static content, and we are comfortable avoiding
XSS protection and strict SSL enforcement for static content. That, and it&amp;rsquo;s
served by github pages/cloudflare, so it&amp;rsquo;s hard to get very granular about
the headers we want set.&amp;nbsp;&lt;a href="#fnref2" rev="footnote"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;

&lt;li id="fn3"&gt;
&lt;p&gt;So if you&amp;rsquo;re especially paranoid, you might be thinking &amp;ldquo;what if I
had some secret subdomain that I don&amp;rsquo;t want leaking for some reason?&amp;rdquo; You have
DNS zone transfers disabled, so someone would have to know what they&amp;rsquo;re looking
for to find it, but now that it&amp;rsquo;s in the preload list&amp;hellip;&amp;nbsp;&lt;a href="#fnref3" rev="footnote"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;

&lt;li id="fn4"&gt;
&lt;p&gt;The &lt;code&gt;Referer&lt;/code&gt; header is
the &lt;a href="http://www.hamsterdance.org/hamsterdance/"&gt;Hampster Dance&lt;/a&gt; in that it&amp;rsquo;s
notorious for being misspelled. It would break the web to try to backport
the correct spelling, so instead the W3C decided to go for the worst of both
worlds and spell it correctly in &lt;code&gt;Referrer-Policy&lt;/code&gt;.&amp;nbsp;&lt;a href="#fnref4" rev="footnote"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;

&lt;/ol&gt;
&lt;/div&gt;
</content>
    <category term="Security"/>
    <category term="Programming"/>
    <category term="Web"/>
  </entry>
  <entry>
    <title>Good News: Ubuntu Now Ships With unattended-upgrades On By Default!</title>
    <link rel="alternate" href="http://blog.appcanary.com/2016/unattended-upgrades.html"/>
    <id>http://blog.appcanary.com/2016/unattended-upgrades.html</id>
    <published>2016-11-14T19:00:00-05:00</published>
    <updated>2017-01-10T17:51:38-05:00</updated>
    <author>
      <name>Max Veytsman</name>
    </author>
    <summary type="html">&lt;p&gt;Last week, we got a strange support request. One of our users had received the following notification:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Hey! Good job.&lt;/p&gt;

&lt;p&gt;We’ve detected that you patched some vulnerabilities.&lt;/p&gt;

&lt;p&gt;Here’s what changed:&lt;/p&gt;

&lt;p&gt;&lt;a href="https://appcanary.com/vulns/46220"&gt;CVE-2016-8704&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;is no longer present in:&lt;/p&gt;

&lt;p&gt;[name of...&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    <content type="html">&lt;p&gt;Last week, we got a strange support request. One of our users had received the following notification:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Hey! Good job.&lt;/p&gt;

&lt;p&gt;We&amp;rsquo;ve detected that you patched some vulnerabilities.&lt;/p&gt;

&lt;p&gt;Here&amp;rsquo;s what changed:&lt;/p&gt;

&lt;p&gt;&lt;a href="https://appcanary.com/vulns/46220"&gt;CVE-2016-8704&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;is no longer present in:&lt;/p&gt;

&lt;p&gt;[name of server redacted]&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;This came as a surprise, since they knew for a fact that no one had touched the package in
question, and they were certain they had not enabled unattended upgrades. &lt;/p&gt;

&lt;p&gt;Somehow, the vulnerability magically got patched and they wanted to
know: what&amp;rsquo;s going on?&lt;/p&gt;

&lt;p&gt;The vuln is a pretty serious remote code execution vulnerability in &lt;code&gt;memcached&lt;/code&gt;,
and as far as we could tell our user was indeed using the most recent version available for their
distribution &amp;mdash; &lt;code&gt;1.4.25-2ubuntu2.1&lt;/code&gt;. This version was released on November 3rd, and we could see from our logs that
&lt;code&gt;memcached&lt;/code&gt; got upgraded that same day.&lt;/p&gt;

&lt;p&gt;How did it happen without them knowing about it? The only thing unique about
their configuration was that they&amp;rsquo;re running the recently released Ubuntu 16.10 (Yakkety
Yak)&lt;sup id="fnref1"&gt;&lt;a href="#fn1" rel="footnote"&gt;1&lt;/a&gt;&lt;/sup&gt;. &lt;/p&gt;

&lt;p&gt;We dug around, and set up some test Yakkety boxes, and
lo and behold: unattended upgrades is automatically enabled by default!&lt;/p&gt;

&lt;p&gt;For those of you who are unaware, &lt;code&gt;unattended-upgrades&lt;/code&gt; is a debian/ubuntu package that, well, does what it says on the
tin: it automatically upgrades your packages. The most common configuration, and the one enabled in 16.10, is to upgrade any packages that have a published security patch. Unattended upgrades does this by checking and installing any
updates from the &lt;code&gt;${distro_codename}-security&lt;/code&gt; repository.&lt;/p&gt;

&lt;p&gt;Ubuntu/debian has had this for years, but it simply was never turned on by
default. After a year of many
&lt;a href="https://blog.appcanary.com/2016/vikhal-symantec.html"&gt;security&lt;/a&gt;
&lt;a href="https://blog.appcanary.com/2016/mirai-botnet-security-broken.html"&gt;fails&lt;/a&gt;, this
news warmed the cockles of my heart and gave me hope for our future! And what&amp;rsquo;s
even amazing is that they turned it on without any fanfare. &lt;/p&gt;

&lt;p&gt;It&amp;rsquo;s the quiet,
simple changes that provide the biggest wins.&lt;/p&gt;

&lt;p&gt;Of course, there are reasons why administrators don&amp;rsquo;t always want software to be upgraded without
their input. And if it does get updated, there are good reasons for knowing exactly what vulnerabilities are being patched when.
&lt;a href="https://appcanary.com/?utm_source=blog&amp;amp;utm_medium=web&amp;amp;utm_campaign=unattended"&gt;Appcanary&lt;/a&gt; exists in order to allow you to be notified
about security updates without automatically installing them, and to have
insight into what&amp;rsquo;s going being installed if you are patching automatically.&lt;/p&gt;

&lt;p&gt;But if you don&amp;rsquo;t have the capacity to actively manage the packages on your
linux systems (and even if you do!), we implore you: set up &lt;code&gt;unattended-upgrades&lt;/code&gt;!&lt;/p&gt;

&lt;p&gt;Ubuntu enabling this by default is a great sign for the future.&lt;/p&gt;

&lt;h2 id="not-running-ubuntu-16-10"&gt;Not running Ubuntu 16.10?&lt;/h2&gt;

&lt;p&gt;Here&amp;rsquo;s how to turn on unattended upgrades&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Ansible: &lt;a href="https://galaxy.ansible.com/jnv/unattended-upgrades/"&gt;jnv.unattended-upgrades&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Puppet: &lt;a href="https://forge.puppet.com/puppet/unattended_upgrades"&gt;puppet/unattended_upgrades&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Chef: &lt;a href="https://supermarket.chef.io/cookbooks/apt"&gt;apt&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;If you&amp;rsquo;re using the server interactively: &lt;/p&gt;

&lt;p&gt;&lt;code&gt;sudo apt-get install unattended-upgrades &amp;amp;&amp;amp; sudo dpkg-reconfigure unattended-upgrades&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Set up manually: &lt;code&gt;sudo apt-get install unattended-upgrades&lt;/code&gt; and&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;In &lt;code&gt;/etc/apt/apt.conf.d/20auto-upgrades&lt;/code&gt;:&lt;/p&gt;
&lt;pre class="highlight plaintext"&gt;&lt;code&gt;APT::Periodic::Update-Package-Lists "1";
APT::Periodic::Unattended-Upgrade "1";
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;In &lt;code&gt;/etc/apt/apt.conf.d/50unattended-upgrades&lt;/code&gt;&lt;/p&gt;
&lt;pre class="highlight plaintext"&gt;&lt;code&gt;// Automatically upgrade packages from these (origin, archive) pairs
Unattended-Upgrade::Allowed-Origins {    
// ${distro_id} and ${distro_codename} will be automatically expanded
    "${distro_id} ${distro_codename}-security";
};

// Send email to this address for problems or packages upgrades
// If empty or unset then no email is sent, make sure that you 
// have a working mail setup on your system. The package 'mailx'
// must be installed or anything that provides /usr/bin/mail.
//Unattended-Upgrade::Mail "root@localhost";

// Do automatic removal of new unused dependencies after the upgrade
// (equivalent to apt-get autoremove)
//Unattended-Upgrade::Remove-Unused-Dependencies "false";

// Automatically reboot *WITHOUT CONFIRMATION* if a 
// the file /var/run/reboot-required is found after the upgrade 
//Unattended-Upgrade::Automatic-Reboot "false";
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;div class="footnotes"&gt;
&lt;hr&gt;
&lt;ol&gt;

&lt;li id="fn1"&gt;
&lt;p&gt;16.10 is not a Long Term Support release. Regular Ubuntu releases
are supported for 9 months, while April releases on even years (i.e. 14.04,
16.04, etc&amp;hellip;) are designated LTS, and are supported for 5 years. It&amp;rsquo;s thus
more common to see 12.04, 14.04, and 16.04 in use on servers over other
Ubuntu releases. This particular user has a good reason for running 16.10.&amp;nbsp;&lt;a href="#fnref1" rev="footnote"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;

&lt;/ol&gt;
&lt;/div&gt;
</content>
    <category term="Clojure"/>
    <category term="Programming"/>
    <category term="Ruby"/>
  </entry>
  <entry>
    <title>We Left Clojure. Here's 5 Things I'll Miss.</title>
    <link rel="alternate" href="http://blog.appcanary.com/2016/missing-clojure.html"/>
    <id>http://blog.appcanary.com/2016/missing-clojure.html</id>
    <published>2016-11-06T19:00:00-05:00</published>
    <updated>2017-01-10T17:51:38-05:00</updated>
    <author>
      <name>Max Veytsman</name>
    </author>
    <summary type="html">&lt;p&gt;On October 11th, Appcanary relied on about 8,500 lines of clojure code. On the
12th we were down to zero. We replaced it by adding another 5,700 lines of Ruby to our codebase. 
&lt;a href="https://twitter.com/phillmv"&gt;Phill&lt;/a&gt; will be discussing why we left, and what we learned both here and...&lt;/p&gt;</summary>
    <content type="html">&lt;p&gt;On October 11th, Appcanary relied on about 8,500 lines of clojure code. On the
12th we were down to zero. We replaced it by adding another 5,700 lines of Ruby to our codebase. 
&lt;a href="https://twitter.com/phillmv"&gt;Phill&lt;/a&gt; will be discussing why we left, and what we learned both here and &lt;a href="http://rubyconf.org/program#prop_19"&gt;at this year&amp;rsquo;s RubyConf&lt;/a&gt;. For now, I want to talk about what I&amp;rsquo;ll miss.&lt;/p&gt;

&lt;h3 id="1-the-joy-of-lisp"&gt;1) The joy of Lisp&lt;/h3&gt;

&lt;p&gt;&lt;a href="https://xkcd.com/297/"&gt;&lt;img alt="XKCD #297" src="http://imgs.xkcd.com/comics/lisp_cycles.png" /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;There&amp;rsquo;s something magical about writing lisp. Alan Kay called it the greatest
single programming language ever devised. Paul Graham called it a
secret weapon. You can find tens of thousands
of words on the elegant, mind-expanding powers of lisp&lt;sup id="fnref1"&gt;&lt;a href="#fn1" rel="footnote"&gt;1&lt;/a&gt;&lt;/sup&gt;. I don&amp;rsquo;t think
my version of the Lisp wizardry blog post would be particularly original or
unique, so if you want to know more about the agony and ecstasy of wielding
parenthesis, read &lt;a href="http://paulgraham.com/avg.html"&gt;Paul Graham&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;What&amp;rsquo;s great about Clojure is that while Ruby
&lt;a href="http://www.randomhacks.net/2005/12/03/why-ruby-is-an-acceptable-lisp/"&gt;might be an acceptable lisp&lt;/a&gt;,
and lisp might
&lt;a href="http://steve-yegge.blogspot.ca/2006/04/lisp-is-not-acceptable-lisp.html"&gt;not be an acceptable lisp&lt;/a&gt;,
Clojure is a more than acceptable lisp. If we avoid the minefield of type
systems, Clojure addresses the other 4 problems Steve Yegge discusses in the previous link&lt;sup id="fnref2"&gt;&lt;a href="#fn2" rel="footnote"&gt;2&lt;/a&gt;&lt;/sup&gt;.&lt;/p&gt;

&lt;h3 id="2-immutability"&gt;2) Immutability&lt;/h3&gt;

&lt;p&gt;The core data structures in clojure are immutable. If I define &lt;code&gt;car&lt;/code&gt; to be &lt;code&gt;&amp;quot;a dirty van&amp;quot;&lt;/code&gt;,
nothing can ever change that. I can name some other thing &lt;code&gt;car&lt;/code&gt; later, but
anything referencing that first &lt;code&gt;car&lt;/code&gt; will always be referencing &lt;code&gt;&amp;quot;a dirty van&amp;quot;&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;This is great for a host of reasons. For one, you get parallelization for free &amp;mdash;
since nothing will mutate your collection, mapping or reducing some function
over it can be hadooped out to as many clouds as you want without changing your
algorithms.&lt;/p&gt;

&lt;p&gt;It&amp;rsquo;s also much easier to can reason about your code. There&amp;rsquo;s a famous quote by Larry Wall:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;[Perl] would prefer that you stayed out of its living room because you weren&amp;rsquo;t
invited, not because it has a shotgun.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;He was talking about private methods, but the same is true for mutability in most languages. You call some method and who knows if it mutated a value you were using? You would prefer it not to, but you have no shotgun, and frankly it&amp;rsquo;s so easy to mutate state without even knowing that you are. Consider Python:&lt;/p&gt;
&lt;pre class="highlight python"&gt;&lt;code&gt;&lt;span class="n"&gt;str1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;"My name "&lt;/span&gt;
&lt;span class="n"&gt;str2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;str1&lt;/span&gt;
&lt;span class="n"&gt;str1&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="s"&gt;"is Max"&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;str1&lt;/span&gt;
&lt;span class="c"&gt;# "My name is Max"&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;str2&lt;/span&gt;
&lt;span class="c"&gt;# "My name"&lt;/span&gt;

&lt;span class="n"&gt;list1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;list2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;list1&lt;/span&gt;
&lt;span class="n"&gt;list1&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;list1&lt;/span&gt;
&lt;span class="c"&gt;# [1, 2, 3, 4, 5]&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;list2&lt;/span&gt;
&lt;span class="c"&gt;# [1, 2, 3, 4, 5]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Calling &lt;code&gt;+=&lt;/code&gt; on a string returned a new one, while calling &lt;code&gt;+=&lt;/code&gt; on a list
mutated it in place! I have to remember which types are mutable, and whether
&lt;code&gt;+=&lt;/code&gt; will give me a new object or mutate the existing one depending on its type.
Who knows what might happen when you start passing your variables by reference
to somewhere else?&lt;/p&gt;

&lt;p&gt;Not having the choice to mutate state is as liberating as getting rid of your Facebook account.&lt;/p&gt;

&lt;h3 id="3-data-first-programming"&gt;3) Data first programming&lt;/h3&gt;

&lt;p&gt;Walking away from object-oriented languages is very freeing. &lt;/p&gt;

&lt;p&gt;I want to design a model for the game of poker. I start by listing the
nouns&lt;sup id="fnref3"&gt;&lt;a href="#fn3" rel="footnote"&gt;3&lt;/a&gt;&lt;/sup&gt;: &amp;ldquo;card&amp;rdquo;, &amp;ldquo;deck&amp;rdquo;, &amp;ldquo;hand&amp;rdquo;, &amp;ldquo;player&amp;rdquo;, &amp;ldquo;dealer&amp;rdquo;, etc. Then I
think of the verbs, &amp;ldquo;deal&amp;rdquo;, &amp;ldquo;bet&amp;rdquo;, &amp;ldquo;fold&amp;rdquo;, etc. &lt;/p&gt;

&lt;p&gt;Now what?
&lt;a href="http://stackoverflow.com/questions/19553838/oop-design-quesiton-with-a-card-game"&gt;Here&amp;rsquo;s&lt;/a&gt;
a typical StackOverflow question demonstrating the confusion that comes with
designing like this. Is the dealer a kind of player or a separate class? If
players have hands of cards, how does the deck keep track of what cards are
left? &lt;/p&gt;

&lt;p&gt;At the end of the day, the work of programming a poker game is codifying all of
the actual rules of the game, and these will end up in a &lt;code&gt;Game&lt;/code&gt; singleton that
does most of the work anyway. &lt;/p&gt;

&lt;p&gt;If you start by thinking about data and the functions that operate on it,
there&amp;rsquo;s a natural way to solve hard problems from the top-down, which lets you quickly iterate your
design (see below). You have some data structure that represents the game
state, a structure representing possible actions a player can take, and a
function to transform a game state and an action into the next game state. That
function encodes the actual rules of poker (defined in lots of other, smaller
functions).&lt;/p&gt;

&lt;p&gt;I find this style of programming very natural and satisfying. Of course, you can
do this in any language; but I find Clojure draws me towards it, while OO
languages push me away from it.&lt;/p&gt;

&lt;h3 id="4-unit-testing"&gt;4) Unit Testing&lt;/h3&gt;

&lt;p&gt;The majority of your code is made up of pure functions. A pure function is one
which always gives the same output for a given input &amp;mdash; doesn&amp;rsquo;t that sound
easy to test? Instead of setting up test harnesses databases and mocks, you just
write tests for your functions.&lt;/p&gt;

&lt;p&gt;Testing the edges of your code that talk to the outside world requires mocking,
of course, and integration testing is never trivial. But the first thing you want to
test is the super-complicated piece of business logic deep in your
codebase. The business logic your business depends on, like for instance computing
whether your version of OpenSSL is vulnerable to HeartBleed. &lt;/p&gt;

&lt;p&gt;Clojure pushes you
to make that bit of code a pure function that&amp;rsquo;s testable without setting
up complicated state.&lt;/p&gt;

&lt;h3 id="5-refactoring"&gt;5) Refactoring&lt;/h3&gt;

&lt;p&gt;Here&amp;rsquo;s a typical clojure function&lt;/p&gt;
&lt;pre class="highlight clojure"&gt;&lt;code&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;defn&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;foo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;
  &lt;/span&gt;&lt;span class="c1"&gt;;; some code here
&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nf"&gt;some-function&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;&lt;span class="w"&gt;
    &lt;/span&gt;&lt;span class="c1"&gt;;; a ton of 
&lt;/span&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;;; complicated code here
&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;In lisp-speak, a parenthesized block is called a &amp;ldquo;form&amp;rdquo;. The &lt;code&gt;foo&lt;/code&gt; form is the outer form, and it contains the &lt;code&gt;let&lt;/code&gt; form, which ostensibly contains other forms that do complicated things.&lt;/p&gt;

&lt;p&gt;I know that all the complicated code inside of the &lt;code&gt;let&lt;/code&gt; form isn&amp;rsquo;t going to
mutate any state, and that it&amp;rsquo;s only dependent on the &lt;code&gt;a&lt;/code&gt; and &lt;code&gt;b&lt;/code&gt; variables. This means that
refactoring this code out into its own functions is as trivial as selecting
everything between two matching parentheses and cutting and pasting it out. If
you have an editor that supports paredit-style navigation of lisp forms, you can
rearrange code at lightning speed.&lt;/p&gt;

&lt;div class="footnotes"&gt;
&lt;hr&gt;
&lt;ol&gt;

&lt;li id="fn1"&gt;
&lt;p&gt;My favourite essay of this ilk is Mark Tarver&amp;rsquo;s melancholy
&lt;a href="http://www.shenlanguage.org/lambdassociates/htdocs/blog/bipolar.htm"&gt;The Bipolar Lisp Programmer&lt;/a&gt;.
He describes lisp as a language designed by and for brilliant failures. Back
in university, I ate this shit up. My grades were obvious evidence of half the
requirement of being a lisp programmer.&amp;nbsp;&lt;a href="#fnref1" rev="footnote"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;

&lt;li id="fn2"&gt;
&lt;p&gt;I&amp;rsquo;m aware that clojure&amp;rsquo;s &lt;code&gt;gensym&lt;/code&gt; does not a hygenic macro system
make. But, if you have strong opinions on hygenic macros as they relate to
acceptable lisps, this article might not be for you.&amp;nbsp;&lt;a href="#fnref2" rev="footnote"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;

&lt;li id="fn3"&gt;
&lt;p&gt;For the record, I know that this isn&amp;rsquo;t the &amp;ldquo;right&amp;rdquo; way to design OO
programs, but the fact that I have to acknowledge this proves my point.&amp;nbsp;&lt;a href="#fnref3" rev="footnote"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;

&lt;/ol&gt;
&lt;/div&gt;
</content>
    <category term="Clojure"/>
    <category term="Programming"/>
    <category term="Ruby"/>
  </entry>
  <entry>
    <title>The Mirai Botnet is Proof the Security Industry is Broken</title>
    <link rel="alternate" href="http://blog.appcanary.com/2016/mirai-botnet-security-broken.html"/>
    <id>http://blog.appcanary.com/2016/mirai-botnet-security-broken.html</id>
    <published>2016-10-30T20:00:00-04:00</published>
    <updated>2016-11-01T09:23:18-04:00</updated>
    <author>
      <name>Max Veytsman</name>
    </author>
    <summary type="html">&lt;p&gt;Last Friday, my workday was rudely interrupted because I couldn’t access Github.
To add insult to injury I couldn’t even complain about it on Twitter. I tried to
drown my sorrows by listening to moody Leonard Cohen songs on Spotify, but
alas…&lt;/p&gt;

&lt;p&gt;You...&lt;/p&gt;</summary>
    <content type="html">&lt;p&gt;Last Friday, my workday was rudely interrupted because I couldn&amp;rsquo;t access Github.
To add insult to injury I couldn&amp;rsquo;t even complain about it on Twitter. I tried to
drown my sorrows by listening to moody Leonard Cohen songs on Spotify, but
alas&amp;hellip;&lt;/p&gt;

&lt;p&gt;You&amp;rsquo;ve probably heard of this. Huge tracts of the Internet were down because the DNS provider Dyn 
faced a massive Denial of Service attack from the
&lt;a href="https://krebsonsecurity.com/2016/10/hacked-cameras-dvrs-powered-todays-massive-internet-outage/"&gt;Mirai botnet&lt;/a&gt;, 
which takes advantage of Internet of Things devices like cameras and DVRs.&lt;/p&gt;

&lt;p&gt;&lt;blockquote class="twitter-tweet" data-lang="en"&gt;&lt;p lang="en" dir="ltr"&gt;&amp;ldquo;Oh &amp;amp; also, evil sorcerers crippled our divination network Friday by getting millions of coffee makers &amp;amp; lightswitches to shout real loud&amp;rdquo; &lt;a href="https://t.co/OPhdOJLwc1"&gt;https://t.co/OPhdOJLwc1&lt;/a&gt;&lt;/p&gt;&amp;mdash; Max Gladstone (@maxgladstone) &lt;a href="https://twitter.com/maxgladstone/status/790890882543288320"&gt;October 25, 2016&lt;/a&gt;&lt;/blockquote&gt;
&lt;script async src="//platform.twitter.com/widgets.js" charset="utf-8"&gt;&lt;/script&gt;&lt;/p&gt;

&lt;h3 id="so-what-39-s-new-about-mirai"&gt;So, what&amp;rsquo;s new about Mirai?&lt;/h3&gt;

&lt;p&gt;I&amp;rsquo;ve written about
1988&amp;rsquo;s &lt;a href="https://blog.appcanary.com/2016/tale-of-two-worms.html"&gt;Morris worm&lt;/a&gt;, 
and I wanted to dig into the
&lt;a href="https://github.com/jgamblin/Mirai-Source-Code"&gt;source&lt;/a&gt; of the Mirai botnet
(helpfully published by the author) to see how far we&amp;rsquo;ve come along in the past
28 years.&lt;/p&gt;

&lt;p&gt;Can you guess how Mirai spreads? &lt;/p&gt;

&lt;p&gt;Was there new zeroday in the devices? Hey, maybe there was an old, unpatched
vulnerability hanging &amp;mdash; who has time to apply software updates to their toaster? 
Maybe it was HeartBleed 👻?&lt;/p&gt;

&lt;p&gt;Nope.&lt;/p&gt;

&lt;p&gt;Mirai does one, and only one thing in order to break into new devices: it cycles through a bunch of default
username/password combinations over telnet, like &amp;ldquo;admin/admin&amp;rdquo; and &amp;ldquo;root/realtek&amp;rdquo;. For a
laugh, &amp;ldquo;mother/fucker&amp;rdquo; is in there too.&lt;/p&gt;

&lt;p&gt;Default credentials. Over telnet. That&amp;rsquo;s how you get hundreds of thousands of
&lt;a href="http://dyn.com/blog/dyn-analysis-summary-of-friday-october-21-attack/"&gt;devices&lt;/a&gt;.
The Morris worm from 1988 tried a dictionary password attack too, but only after
its buffer overflow and sendmail backdoor exploits failed. &lt;/p&gt;

&lt;p&gt;Oh, and Morris&amp;rsquo; password dictionary was larger, too.&lt;/p&gt;

&lt;h3 id="how-do-we-keep-getting-this-wrong"&gt;How do we keep getting this wrong?&lt;/h3&gt;

&lt;p&gt;Around the world, we spend $75 billion a year on information security.
And for what, when we keep getting such basic things wrong? Suppose I waved a
magic wand and cut the worldwide security budget in half. Would things really be
that much worse? The security industry is addicted to selling expensive
complicated products instead of doing the basics well. &lt;/p&gt;

&lt;p&gt;I was at a security conference the other week, and there was yet another crop of
cyberapocalypse talks. The Internet of Things is a garbage fire. Industrial control
systems are going to get us all killed. Users are clicking phishing links like
sheep. We&amp;rsquo;re all doomed. And somehow, it&amp;rsquo;s always the fault of shitty
programmers or dumb users. Let&amp;rsquo;s all laugh at their fails.&lt;/p&gt;

&lt;h3 id="it-39-s-all-bullshit"&gt;It&amp;rsquo;s all bullshit.&lt;/h3&gt;

&lt;p&gt;We sell biometric authentication systems to people who need a good password
manager. We sell live threat attribution intelligence with colorful maps to
people who need to practice configuration management. We sell advanced
in-cpu sandbox endpoint protection to people who need to institute a patching program.
There&amp;rsquo;s a reason why security practitioners get such a kick out of
&lt;a href="https://threatbutt.com/"&gt;ThreatButt&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;There are lots of real, important, conceptually difficult problems in
security. We don&amp;rsquo;t really know how to write secure code, and it&amp;rsquo;s all too
easy to get socially engineered. But, right now, the vast majority of threats can be thwarted by &lt;b&gt;the basics&lt;/b&gt;:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;Keep your systems patched&lt;/li&gt;
&lt;li&gt;Keep your systems properly configured.&lt;/li&gt;
&lt;li&gt;Make sure you have strong passwords and two factor authentication.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Do the basics first. The basics matter. Then you can focus on the Sisyphean
tasks that remain. Instead, here we are selling fancy bullshit and barely making
any progress in 28 years. Lots of money in it, though.&lt;/p&gt;

&lt;hr&gt;

&lt;h4 id="paying-the-bills"&gt;Paying the Bills&lt;/h4&gt;

&lt;p&gt;Surprise, I also sell a security product! But I will say this: Appcanary
isn&amp;rsquo;t going to protect you from shipping millions of internet-accessible
cameras with the same password. We won&amp;rsquo;t even protect you from having your DNS
provider DoSed.&lt;/p&gt;

&lt;p&gt;The major botnet of 2016 is &lt;em&gt;simpler&lt;/em&gt; than the botnet of 1988. There&amp;rsquo;s something
wrong in how we do security, and at Appcanary, we think it&amp;rsquo;s a complete lack of
focus on the basics. &lt;/p&gt;

&lt;p&gt;The highest value, easiest thing you can do to improve your security is patch
known vulnerabilities. Most breaches come from years-old vulnerabilities. &lt;/p&gt;

&lt;p&gt;Our product,
&lt;a href="https://appcanary.com/?utm_source=blog&amp;amp;utm_medium=web&amp;amp;utm_campaign=broken"&gt;Appcanary&lt;/a&gt;,
monitors your apps and servers, and notifies you whenever a new vulnerability is
discovered in a package you rely on.&lt;/p&gt;

&lt;p&gt;&lt;a href="https://appcanary.com/sign_up?utm_source=blog&amp;amp;utm_medium=web&amp;amp;utm_campaign=broken"&gt;Sign up&lt;/a&gt; today!&lt;/p&gt;
</content>
    <category term="security"/>
    <category term="mirai"/>
    <category term="botnet"/>
  </entry>
  <entry>
    <title>A tale of two worms, three vulnerabilities, and one National Security Agency</title>
    <link rel="alternate" href="http://blog.appcanary.com/2016/tale-of-two-worms.html"/>
    <id>http://blog.appcanary.com/2016/tale-of-two-worms.html</id>
    <published>2016-08-23T20:00:00-04:00</published>
    <updated>2017-01-13T09:15:13-05:00</updated>
    <author>
      <name>Max Veytsman</name>
    </author>
    <summary type="html">&lt;p&gt;Paranoia is natural for security practitioners. &lt;/p&gt;

&lt;p&gt;Hacking can feel like being initiated into a secret society of wizards.
Once you’re in, you get access to an
&lt;a href="https://docs.google.com/presentation/d/1Sv8IHkBtBEXjSW7WktEYg4EbAUHtVyXIZBrAGD3WR5Y/edit?pref=2&amp;amp;pli=1#slide=id.p" target="_blank"&gt;addictive drug&lt;/a&gt;
that gives you super powers. But there are other wizards out there; some are...&lt;/p&gt;</summary>
    <content type="html">&lt;p&gt;Paranoia is natural for security practitioners. &lt;/p&gt;

&lt;p&gt;Hacking can feel like being initiated into a secret society of wizards.
Once you&amp;rsquo;re in, you get access to an
&lt;a href="https://docs.google.com/presentation/d/1Sv8IHkBtBEXjSW7WktEYg4EbAUHtVyXIZBrAGD3WR5Y/edit?pref=2&amp;pli=1#slide=id.p" target="_blank"&gt;addictive drug&lt;/a&gt;
that gives you super powers. But there are other wizards out there; some are good
but many practice black magic. And the NSA&amp;rsquo;s school of the dark arts has a seemingly
unlimited budget. &lt;/p&gt;

&lt;p&gt;It&amp;rsquo;s natural to get a little paranoid. Experience shows you
that with the right incantation you can turn crashes into working exploits. It
follows that every time your computer crashes there could be someone in the
shadows, chanting the right incantation. The paranoia can be all-consuming;
just because you&amp;rsquo;re paranoid doesn&amp;rsquo;t mean they&amp;rsquo;re not &lt;a href="http://www.nytimes.com/2011/07/02/opinion/02hotchner.html?_r=0" target="_blank"&gt;out to get you&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;In October 2013, a well known computer security expert named Dragos Ruiu came
out with a &lt;a href="http://arstechnica.com/security/2013/10/meet-badbios-the-mysterious-mac-and-pc-malware-that-jumps-airgaps/" target="_blank"&gt;story&lt;/a&gt;. He found that his computers had been behaving oddly, and that the symptoms he was seeing were impossible to eradicate. This was some kind of worm, since the behavior would
replicate across &lt;a href="https://en.wikipedia.org/wiki/Air_gap_(networking)" target="_blank"&gt;air gapped&lt;/a&gt; computers in his lab. He theorized that he
was infected with a super advanced piece of malware that lived in the BIOS and
could spread by sending ultrasonic frequencies from speaker to
microphone, undetectable to the human ear. It looked like
the work of the NSA or someone equally omnipotent. He dubbed it badBIOS. &lt;/p&gt;

&lt;p&gt;Everything Dragos claimed badBIOS could do is at least possible, and most security folks know this. Malware in the BIOS is feasible, and beyond being a &lt;a href="https://www.wired.com/2015/03/researchers-uncover-way-hack-bios-undermine-secure-operating-systems/" target="_blank"&gt;research&lt;/a&gt; topic, it&amp;rsquo;s something we &lt;a href="https://www.schneier.com/blog/archives/2015/02/the_equation_gr.html" target="_blank"&gt;know&lt;/a&gt; the &lt;a href="http://www.spiegel.de/international/world/catalog-reveals-nsa-has-back-doors-for-numerous-devices-a-940994.html" target="_blank"&gt;NSA does&lt;/a&gt;. In fact, because of the hype, &lt;a href="https://github.com/Katee/quietnet" target="_blank"&gt;many&lt;/a&gt; &lt;a href="https://www.anfractuosity.com/projects/ultrasound-networking/" target="_blank"&gt;people&lt;/a&gt; developed ultrasound networking libraries just to demonstrate how viable it is. &lt;/p&gt;

&lt;p&gt;Dragos Ruiu imaged his computer and made a lot of data available to the
community for peer review, but unfortunately no credible researcher&lt;sup id="fnref1"&gt;&lt;a href="#fn1" rel="footnote"&gt;1&lt;/a&gt;&lt;/sup&gt; has publicly confirmed his findings. Maybe there was something going on. Maybe he was seeing patterns in the noise. Either way, it says something about the world today that when you&amp;rsquo;re a security expert and your computer starts behaving weirdly, the obvious culprit is the NSA.&lt;/p&gt;

&lt;p&gt;It made me think of a different worm, from a more innocent time.&lt;/p&gt;

&lt;p&gt;&lt;img alt="Morris Worm" src="/images/morris_worm.jpg" /&gt;&lt;/p&gt;

&lt;h2 id="the-morris-worm"&gt;The Morris Worm&lt;/h2&gt;

&lt;p&gt;It&amp;rsquo;s November 2nd 1988, almost exactly 25 years before badBIOS became a
hashtag. Robert Tappan Morris, a graduate student at Cornell, executes some
code he&amp;rsquo;d been working on and goes to dinner. The aftermath was a
self-replicating computer worm that infected 10% of the Internet&lt;sup id="fnref2"&gt;&lt;a href="#fn2" rel="footnote"&gt;2&lt;/a&gt;&lt;/sup&gt; at
the time &amp;mdash; a whopping 6,000 computers!&lt;/p&gt;

&lt;p&gt;Morris claimed that he wrote his program to map the size of the Internet. And
indeed, each infection would send a byte to a machine in Berkeley
(hiding the trail to Morris, in Cornell, as the author). Unfortunately,
there was a bug that caused it to propagate too aggressively: it infected the same
computer multiple times, which resulted in a denial of service attack across the
whole Internet. Furthermore, the code to report infections had a bug in it. It tried to
send a UDP packet over a TCP socket, making it useless for reporting the Internet&amp;rsquo;s size.&lt;/p&gt;

&lt;p&gt;An alternative explanation is that Morris was trying to bring to wider attention
some long-standing bugs in the Internet. As Morris&amp;rsquo; friend and future co-founder &lt;a href="http://www.nytimes.com/1988/11/07/us/computer-invasion-back-door-ajar.html" target="_blank"&gt;put it&lt;/a&gt;, in classic pg&lt;sup id="fnref3"&gt;&lt;a href="#fn3" rel="footnote"&gt;3&lt;/a&gt;&lt;/sup&gt; style:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Mr. Graham, who has known the younger Mr. Morris for several years, compared
his exploit to that of Mathias Rust, the young German who flew light plane
through Soviet air defenses in May 1987 and landed in Moscow.&lt;/p&gt;

&lt;p&gt;&amp;ldquo;It&amp;rsquo;s as if &lt;a href="https://en.wikipedia.org/wiki/Mathias_Rust" target="_blank"&gt;Mathias Rust&lt;/a&gt; had not just flown into Red Square, but built
himself a stealth bomber by hand and then flown into Red Square,&amp;rdquo; he said.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id="what-did-the-morris-worm-actually-do"&gt;What did the Morris Worm actually do?&lt;/h3&gt;

&lt;p&gt;The Morris Worm&lt;sup id="fnref4"&gt;&lt;a href="#fn4" rel="footnote"&gt;4&lt;/a&gt;&lt;/sup&gt; exploited three separate vulnerabilities. It guessed
passwords for &lt;code&gt;rsh&lt;/code&gt;/&lt;code&gt;rexec&lt;/code&gt;, it exploited a debug-mode backdoor in sendmail and it used &amp;ldquo;one
very neat trick&amp;rdquo;. I&amp;rsquo;ll go over each of these in detail, and you can find an archive (decompiled and commented) of the code for yourself &lt;a href="https://github.com/arialdomartini/morris-worm" target="_blank"&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;h4 id="1-rsh-and-rexec"&gt;1. Rsh and Rexec&lt;/h4&gt;

&lt;p&gt;&lt;code&gt;rsh&lt;/code&gt; and &lt;code&gt;rexec&lt;/code&gt; are remote shell protocols from the BSD era that are almost
unused today (since supplanted by &lt;code&gt;ssh&lt;/code&gt;). &lt;code&gt;rsh&lt;/code&gt; can allow passwordless
authentication if coming from a &amp;ldquo;trusted&amp;rdquo; host, which it determines via a list of addresses stored in a global &lt;code&gt;/etc/hosts.equiv&lt;/code&gt; or
per-user &lt;code&gt;.rhosts&lt;/code&gt; file. When an
&lt;code&gt;rsh&lt;/code&gt; request comes from a user of a trusted machine, access is automatically
granted. The worm used this to propagate, searching those two files &amp;mdash; as well as the &lt;code&gt;.forward&lt;/code&gt; file, which back then was used to forward your mail around the Internet &amp;mdash; for trusted hosts.&lt;/p&gt;

&lt;p&gt;Even in 1988, people knew that leaving &lt;code&gt;rsh&lt;/code&gt; open on an untrusted network like
the Internet was a Bad Idea, and so the worm also propagated via &lt;code&gt;rexec&lt;/code&gt;.
Now, &lt;code&gt;rexec&lt;/code&gt; uses password authentication, but Morris made an intelligent assumption:
people tend to reuse passwords.
Back then, &lt;code&gt;/etc/passwd&lt;/code&gt; used to&lt;sup id="fnref5"&gt;&lt;a href="#fn5" rel="footnote"&gt;5&lt;/a&gt;&lt;/sup&gt; store everyone&amp;rsquo;s encrypted passwords. The
worm shipped with an optimized implementation of
&lt;a href="https://en.wikipedia.org/wiki/Crypt_(Unix)" target="_blank"&gt;&lt;code&gt;crypt&lt;/code&gt;&lt;/a&gt; and a dictionary, and went to town. Once it cracked a password, it tried it against
all the likely hosts it could find.&lt;/p&gt;

&lt;h4 id="2-sendmail-39-s-backdoor"&gt;2. Sendmail&amp;rsquo;s Backdoor&lt;/h4&gt;

&lt;p&gt;In the absence of any friendly hosts, the Morris Worm would then exploit a
backdoor in &lt;a href="https://en.wikipedia.org/wiki/Sendmail" target="_blank"&gt;Sendmail&lt;/a&gt;. You see, Sendmail had a &amp;ldquo;debug&amp;rdquo; mode that allowed anyone to route an
email to any process, including the shell! Ironically, this was &lt;a href="http://www.nytimes.com/1988/11/07/us/computer-invasion-back-door-ajar.html" target="_blank"&gt;apparently deliberate&lt;/a&gt;:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Eric Allman, a computer programmer who designed the mail program that Morris
exploited, said yesterday that he created the back door to allow him to fine
tune the program on a machine that an overzealous administrator would not give
him access to. He said he forgot to remove the entry point before the program
was widely distributed in 1985.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;(This wasn&amp;rsquo;t even the first Sendmail backdoor. Sendmail used to ship with &amp;ldquo;wizard mode&amp;rdquo;, where sending the strings &amp;ldquo;WIZ&amp;rdquo; and &amp;ldquo;SHELL&amp;rdquo; gave you a root shell. By the time that Morris was writing his worm, wizard mode was disabled almost everywhere.)&lt;/p&gt;

&lt;p&gt;If you&amp;rsquo;re wondering how sendmail could have backdoors like this, it seems that it was somewhat well known. This quote from a &lt;a href="http://securitydigest.org/tcp-ip/archive/1988/11" target="_blank"&gt;mail&lt;/a&gt; by &lt;a href="https://en.wikipedia.org/wiki/Paul_Vixie" target="_blank"&gt;Paul Vixie&lt;/a&gt; summarizes the situation.&lt;/p&gt;
&lt;pre class="highlight plaintext"&gt;&lt;code&gt;From: vixie@decwrl.dec.com (Paul Vixie)
Newsgroups: comp.protocols.tcp-ip,comp.unix.wizards
Subject: Re: a holiday gift from Robert "wormer" Morris
Message-ID: &amp;lt;24@jove.dec.com&amp;gt;
Date: 6 Nov 88 19:36:10 GMT
References: &amp;lt;1698@cadre.dsl.PITTSBURGH.EDU&amp;gt; &amp;lt;2060@spdcc.COM&amp;gt;
Distribution: na
Organization: DEC Western Research Lab
Lines: 15


# the hole [in sendmail] was so obvious that i surmise that Morris
# was not the only one to discover it.  perhaps other less
# reproductively minded arpanetters have been having a field
# 'day' ever since this bsd release happened. 

I've known about it for a long time.  I thought it was common knowledge
and that the Internet was just a darned polite place.  (I think it _was_
common knowledge among the people who like to diddle the sendmail source.)

The bug in fingerd was a big surprise, though.  Overwriting a stack frame
on a remote machine with executable code is One Very Neat Trick.
-- 
Paul Vixie
Work:    vixie@decwrl.dec.com    decwrl!vixie    +1 415 853 6600
Play:    paul@vixie.sf.ca.us     vixie!paul      +1 415 864 7013
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The Internet was a polite place, indeed.&lt;/p&gt;

&lt;h4 id="3-one-very-neat-trick"&gt;3. One Very Neat Trick&lt;/h4&gt;

&lt;p&gt;The Very Neat Trick that Vixie was talking about is the now-standard
&lt;a href="https://en.wikipedia.org/wiki/Buffer_overflow" target="_blank"&gt;stack buffer overflow&lt;/a&gt;. It&amp;rsquo;s
fascinating to read contemporary accounts that marvel at the cleverness of a class of
bugs that are now ubiquitous &amp;mdash; although, for me at least, they still haven&amp;rsquo;t
lost their magic&lt;sup id="fnref6"&gt;&lt;a href="#fn6" rel="footnote"&gt;6&lt;/a&gt;&lt;/sup&gt;.&lt;/p&gt;

&lt;p&gt;Here&amp;rsquo;s the main routine from the &lt;code&gt;fingerd&lt;/code&gt; of that &lt;a href="http://minnie.tuhs.org/cgi-bin/utree.pl?file=4.3BSD/usr/src/etc/fingerd.c" target="_blank"&gt;era&lt;/a&gt;:&lt;/p&gt;
&lt;pre class="highlight c"&gt;&lt;code&gt;&lt;span class="n"&gt;main&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;argc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;[];&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;register&lt;/span&gt; &lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sp&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="n"&gt;line&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;512&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
    &lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="n"&gt;sockaddr_in&lt;/span&gt; &lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;pid&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;status&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kt"&gt;FILE&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;fp&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;av&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;

    &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;sizeof&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;getpeername&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;fatal&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="s"&gt;"getpeername"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;line&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="sc"&gt;'\0'&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;gets&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;line&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;sp&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;line&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="c1"&gt;// ... snip ...
&lt;/span&gt;    &lt;span class="c1"&gt;// build sp into arguments for finger 
&lt;/span&gt;    &lt;span class="c1"&gt;// and call /usr/ucb/finger via execv before
&lt;/span&gt;    &lt;span class="c1"&gt;// putchar'ing the result back to stdout
&lt;/span&gt;    &lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt; 
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;If you have experience with reading C code,&lt;sup id="fnref7"&gt;&lt;a href="#fn7" rel="footnote"&gt;7&lt;/a&gt;&lt;/sup&gt; you may have spotted the
vulnerability. &lt;code&gt;gets(line)&lt;/code&gt; reads STDIN and puts the contents into a 512 byte
buffer. This means that sending more than 512 bytes will overwrite the stack
with an attacker-controlled value.&lt;/p&gt;

&lt;p&gt;The worm sent 536 bytes of data, which overwrote the
&lt;a href="https://en.wikipedia.org/wiki/Call_stack#Stack_and_frame_pointers" target="_blank"&gt;stack frame&lt;/a&gt;
of the &lt;code&gt;main&lt;/code&gt; function. This allowed Morris to overwrite the pointer to where
&lt;code&gt;main&lt;/code&gt; is returning to. He set that pointer to be &lt;em&gt;within&lt;/em&gt; the 536 byte buffer
he sent over the network. The beginning of the buffer contained
&lt;a href="https://en.wikipedia.org/wiki/Shellcode" target="_blank"&gt;shellcode&lt;/a&gt; that called &lt;code&gt;/bin/sh&lt;/code&gt;. Game over.&lt;/p&gt;

&lt;h2 id="aftermath"&gt;Aftermath&lt;/h2&gt;

&lt;p&gt;Robert Tappan Morris was convicted and sentenced to three years probation, 400
hours of community service and a $10,050 fine (about $20,000 in today&amp;rsquo;s dollars)
plus the cost of his supervision. He then went on to co-found a little startup
called Viaweb. You may have heard the rest of that story.
Today, Morris is a tenured professor at the Computer Science and Artificial
Intelligence Laboratory at MIT and is one of the leaders of the Parallel and
Distributed Systems Groups.&lt;/p&gt;

&lt;p&gt;Why did the paranoia around badBIOS make me think of the Morris Worm? If you read contemporary articles about the Morris Worm, they&amp;rsquo;ll sometimes mention, but never emphasize, who Robert Morris&amp;rsquo;s father was. The &lt;a href="https://en.wikipedia.org/wiki/Robert_Morris_(cryptographer)" target="_blank"&gt;elder Robert Morris&lt;/a&gt; just happened to be a computer security expert. While the young Robert Morris was writing his worm, Robert Morris Sr. was serving as Chief Scientist at the NSA&amp;rsquo;s National Computer Security Center! &lt;/p&gt;

&lt;p&gt;The Internet grew up a lot since 1988, and not just in size. In 2013, your computer acting strangely is obviously a NSA-written malware that lives in your BIOS and propagates over sound waves imperceptible to the human ear. In 1988, son of an NSA security executive infects 10% of the Internet with a worm that uses an exotic new exploitation technique called a buffer overflow and&amp;hellip; nothing.&lt;/p&gt;

&lt;p&gt;Just to be clear, I&amp;rsquo;m not alleging any conspiracy between father and son, besides perhaps father making some calls after son&amp;rsquo;s arrest. While the Morris worm was likely the first malicious use, buffer overflows were understood as a problem before 1988, if not widely. The way the media narrative handled the NSA connection in 1988 just says a lot about how the world of the Internet changed in 25 years.&lt;/p&gt;

&lt;p&gt;As for Dragos Ruiu, he&amp;rsquo;s been quiet about badBIOS since 2013. I&amp;rsquo;m not sure what he&amp;rsquo;s doing these days besides &lt;a href="https://cansecwest.com/" target="_blank"&gt;CanSecWest&lt;/a&gt;, but in my heart of hearts, I like to picture him playing the saxophone amidst the detritus of his torn up apartment.&lt;/p&gt;

&lt;p&gt;&lt;a href="https://en.wikipedia.org/wiki/The_Conversation" target="_blank"&gt;&lt;img src="/images/the_conversation.jpg"&gt;&lt;/a&gt;&lt;/p&gt;

&lt;hr&gt;

&lt;h4 id="paying-the-bills"&gt;Paying the Bills&lt;/h4&gt;

&lt;p&gt;We&amp;rsquo;re trying our best, but we&amp;rsquo;ll only be able to blog about a minuscule percentage of the world&amp;rsquo;s vulnerabilities. And starting with 1988 means we have a lot of catching up to do. How will you ever find about the ones that actually affect you?&lt;/p&gt;

&lt;p&gt;Our product, &lt;a href="https://appcanary.com/?utm_source=blog&amp;amp;utm_medium=web&amp;amp;utm_campaign=morris"&gt;Appcanary&lt;/a&gt;, monitors your apps and servers, and notifies you whenever a new vulnerability is discovered in a package you rely on. &lt;/p&gt;

&lt;p&gt;&lt;a href="https://appcanary.com/sign_up?utm_source=blog&amp;amp;utm_medium=web&amp;amp;utm_campaign=morris"&gt;Sign up&lt;/a&gt; today!&lt;/p&gt;

&lt;hr&gt;

&lt;p&gt;&lt;link href="//cdn-images.mailchimp.com/embedcode/horizontal-slim-10_7.css" rel="stylesheet" type="text/css"&gt;
&lt;style type="text/css"&gt;
 #mc&lt;em&gt;embed&lt;/em&gt;signup{background:#fff; clear:left; font:14px Helvetica,Arial,sans-serif; width:100%;}
 /* Add your own MailChimp form style overrides in your site stylesheet or in this style block.
      We recommend moving this block and the preceding CSS link to the HEAD of your HTML file. */
&lt;/style&gt;
&lt;div id="mc_embed_signup"&gt;
&lt;form action="//appcanary.us10.list-manage.com/subscribe/post?u=303b378f377508300c0b5469a&amp;amp;id=dc58e8f56f" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate&gt;
&lt;div id="mc_embed_signup_scroll"&gt;
&lt;label for="mce-EMAIL"&gt;Liked this post? Subscribe to our newsletter for more!&lt;/label&gt;
&lt;input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL" placeholder="email address" required&gt;
&lt;div style="position: absolute; left: -5000px;" aria-hidden="true"&gt;&lt;input type="text" name="b_303b378f377508300c0b5469a_dc58e8f56f" tabindex="-1" value=""&gt;&lt;/div&gt;
&lt;div class="clear"&gt;&lt;input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button"&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/form&gt;
&lt;/div&gt;&lt;/p&gt;

&lt;div class="footnotes"&gt;
&lt;hr&gt;
&lt;ol&gt;

&lt;li id="fn1"&gt;
&lt;p&gt;One of the things I wish that the security industry would do less of is blind appeals to authority, and I hate that I made one here. Unfortunately, I don&amp;rsquo;t have the skills or time to make my own analysis of Ruiu&amp;rsquo;s data, so I just have to trust the Thought Leaders on this one. &amp;nbsp;&lt;a href="#fnref1" rev="footnote"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;

&lt;li id="fn2"&gt;
&lt;p&gt;The 60,000 computer-strong Internet was of course one of many networks at the time. The Internet was the one that was global and used TCP/IP &amp;mdash; the Internet protocols. Therein lies the pedant&amp;rsquo;s case against the &lt;a href="https://twitter.com/APStylebook/status/716279065888563200" target="_blank"&gt;AP&amp;rsquo;s capitalization&lt;/a&gt; of the word &amp;ldquo;Internet&amp;rdquo;.&amp;nbsp;&lt;a href="#fnref2" rev="footnote"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;

&lt;li id="fn3"&gt;
&lt;p&gt;Disclosure time: years after giving that quote, Paul Graham and Robert Morris went on to found Y Combinator along with Jessica Livingston and Trevor Blackwell. YC in turn is an investor in &lt;a href="https://www.appcanary.com"&gt;Appcanary&lt;/a&gt;. Robert Morris and I have never met, though we did once meet with Paul Graham. &amp;nbsp;&lt;a href="#fnref3" rev="footnote"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;

&lt;li id="fn4"&gt;
&lt;p&gt;My favourite paper on the analysis of the worm is &lt;a href="http://denninginstitute.com/modules/acmpkp/security/texts/INTWORM.PDF" target="_blank"&gt;With Microscope and Tweezers&lt;/a&gt; from MIT&amp;rsquo;s Eichin and Rochlis. They spend a page passionately arguing that it&amp;rsquo;s a virus by using a complicated appeal to the difference between lytic and lysogenic viruses with references to three separate biology textbooks!&amp;nbsp;&lt;a href="#fnref4" rev="footnote"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;

&lt;li id="fn5"&gt;
&lt;p&gt;I assumed that &lt;code&gt;/etc/shadow&lt;/code&gt; came about as a consequence of the Morris Worm, but it &lt;a href="https://en.wikipedia.org/wiki/Passwd#History" target="_blank"&gt;seems&lt;/a&gt; that it was originally implemented in SunOS earlier in the 80&amp;rsquo;s, and then took 2 years after the Morris Worm to make it into BSD.&amp;nbsp;&lt;a href="#fnref5" rev="footnote"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;

&lt;li id="fn6"&gt;
&lt;p&gt;Exploits really are magic, and it goes without saying that exploit users have chosen the &lt;a href="https://en.wikipedia.org/wiki/Left-hand_path_and_right-hand_path" target="_blank"&gt;Left-Hand Path&lt;/a&gt; to wizardhood. If the &lt;a href="https://mitpress.mit.edu/sicp/full-text/book/book.html" target="_blank"&gt;cover of SICP&lt;/a&gt; is to be believed, the Right-Hand Path is available through careful study of functional programming and Lisps. Perhaps this is the true reason why Morris and Graham were such effective collaborators.&amp;nbsp;&lt;a href="#fnref6" rev="footnote"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;

&lt;li id="fn7"&gt;
&lt;p&gt;On the other hand, this C code is over 30 years old. When I ran it through the gcc on my machine,I was very happy to see that it complained bitterly but still compiled it. One exercise for the reader is finding where the network operation actually happens. &lt;code&gt;main&lt;/code&gt; takes input and output from STDIN/STDOUT, but there&amp;rsquo;s an uninitialized &lt;code&gt;struct sockaddr_in sin&lt;/code&gt; that we call &lt;code&gt;getpeername&lt;/code&gt; on. How is a network socket piped to standard input/output and who is initializing the &lt;code&gt;sin&lt;/code&gt; struct? I actually haven&amp;rsquo;t been able to figure this part out. If you know, please tell &lt;a href="mailto:max@appcanary.com"&gt;me&lt;/a&gt;! The full code listing is &lt;a href="http://minnie.tuhs.org/cgi-bin/utree.pl?file=4.3BSD/usr/src/etc/fingerd.c" target="_blank"&gt;here&lt;/a&gt;.&amp;nbsp;&lt;a href="#fnref7" rev="footnote"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Update 08/29/2016&lt;/strong&gt; Dave Vandervies emailed me with an explanation!&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;fingerd was meant to be run from inetd (see &lt;a href="http://minnie.tuhs.org/cgi-bin/utree.pl?file=4.3BSD/etc/inetd.conf" target="_blank"&gt;here&lt;/a&gt;),
which sets up the network connection and invokes the actual server process
with its stdin and stdout attached to the network socket.&lt;/p&gt;

&lt;p&gt;&lt;br/&gt;
As for the getpeername, the address is an out parameter; this call looks up
the peer address of stdin (fd 0), and will fail (and fingerd will error out
on that) if it isn&amp;rsquo;t a socket (see
&lt;a href="http://man.openbsd.org/OpenBSD-current/man2/getpeername.2"&gt;here&lt;/a&gt;).
Since the actual address doesn&amp;rsquo;t get used, that appears to be the purpose of the
call here.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;

&lt;/ol&gt;
&lt;/div&gt;
</content>
    <category term="vihkal"/>
    <category term="security"/>
  </entry>
</feed>
